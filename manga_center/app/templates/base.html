<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Manga Center{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <header>
        <h1>Manga Center</h1>
        <nav>
            <a href="{{ url_for('public.index') }}">Home</a> |
            <a href="{{ url_for('public.all_manga') }}">Browse Manga</a>
            {% if current_user.is_authenticated and current_user.is_admin %}
            <a href="{{ url_for('admin.author_requests') }}">Admin Panel</a>
            {% endif %}
            {% if current_user.is_authenticated %}
            <span>Welcome, {{ current_user.username }}!</span>
            <a href="{{ url_for('users.profile') }}">Profile</a>
            <a href="{{ url_for('users.my_library') }}">My Library</a>
            <a href="{{ url_for('users.logout') }}">Logout</a>
            {% else %}
            <a href="{{ url_for('users.login') }}">Login</a>
            <a href="{{ url_for('users.register') }}">Register</a>
            {% endif %}
        </nav>
    </header>

    <main>
        {% block content %}{% endblock %}
    </main>

    <div id="toast-container"></div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('toast-container');

            window.showToast = function (message, type = "info") {
                const toast = document.createElement('div');
                toast.classList.add('toast', `toast-${type}`);
                toast.innerHTML = message;
                container.appendChild(toast);
                setTimeout(() => toast.classList.add('show'), 100);
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 500);
                }, 3000);
            };

            {% with messages = get_flashed_messages(with_categories = true) %}
            {% if messages %}
            {% for category, message in messages %}
            showToast({{ message| tojson }}, {{ category| tojson }});
        {% endfor %}
        {% endif %}
        {% endwith %}
    });
    </script>

    <footer>
        <p>&copy; Manga Center</p>
    </footer>
</body>

</html>